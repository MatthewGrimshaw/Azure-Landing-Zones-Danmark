{
  "properties": {
    "displayName": "Enforce CIS Implementation Group 1 Level 1 controls",
    "policyType": "Custom",
    "description": "This policy initiative is a group of policies that Enforces CIS Implementation Group 1 Level 1 controls.",
    "metadata": {
      "version": "1.0",
      "category": "Regulatory Compliance"
    },
    "parameters": {
      "listOfLinuxImageIdToInclude": {
        "type": "Array",
        "metadata": {
          "displayName": "Additional Virtual Machine Images",
          "description": "List of virtual machine images that have supported Linux OS to add to scope. Example values: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'"
        },
        "defaultValue": []
      },
      "listOfWindowsImageIdToInclude": {
        "type": "Array",
        "metadata": {
          "displayName": "Additional Virtual Machine Images",
          "description": "List of virtual machine images that have supported Windows OS to add to scope. Example values: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'"
        },
        "defaultValue": []
      },
      "retentionDays": {
        "type": "String",
        "metadata": {
          "description": "The value in days of the retention period (0 indicates unlimited retention)",
          "displayName": "Retention days (optional, 180 days if unspecified)"
        },
        "defaultValue": "180"
      },
      "storageAccountsResourceGroup": {
        "type": "String",
        "metadata": {
          "displayName": "Resource group name for storage accounts",
          "description": "Auditing writes database events to an audit log in your Azure Storage account (a storage account will be created in each region where a SQL Server is created that will be shared by all servers in that region). Important - for proper operation of Auditing do not delete or rename the resource group or the storage accounts.",
          "strongType": "existingResourceGroups"
        }
      }
    },
    "policyDefinitions":  [
      {
        "policyDefinitionReferenceId": "ConfigureLinuxVirtualMachinesToRunAzureMonitorAgentWithSystem-assignedManagedIdentity-basedAuthentication",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a4034bc6-ae50-406d-bf76-50f4ee5a7811",
        "parameters": {
          "listOfLinuxImageIdToInclude": {
            "value": "[parameters('listOfLinuxImageIdToInclude')]"
          }
        },
        "groupNames": [
          "CIS_Azure_1.4.0_2.11"
        ]
      },
      {
        "policyDefinitionReferenceId": "ConfigureWindowsVirtualMachinesToRunAzureMonitorAgentUsingSystem-assignedManagedIdentity",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ca817e41-e85a-4783-bc7f-dc532d36235e",
        "parameters": {
          "listOfWindowsImageIdToInclude": {
            "value": "[parameters('listOfWindowsImageIdToInclude')]"
          }
        },
        "groupNames": [
          "CIS_Azure_1.4.0_2.11"
        ]
      },
      {
        "policyDefinitionReferenceId": "ConfigureSQLServersToHaveAuditingEnabled",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f4c68484-132f-41f9-9b6d-3e4b1cb55036",
        "parameters": {
          "retentionDays": {
            "value": "[parameters('retentionDays')]"
          },
          "storageAccountsResourceGroup": {
            "value": "[parameters('storageAccountsResourceGroup')]"
          }
        },
        "groupNames": [
          "CIS_Azure_1.4.0_4.1.1"
        ]
      },
      {
        "policyDefinitionReferenceId": "ConfigureYourStorageAccountPublicAccessToBeDisallowed",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/13502221-8df0-4414-9937-de9c5c4e396b",
        "parameters": {},
        "groupNames": [
          "CIS_Azure_1.4.0_5.1.3",
          "CIS_Azure_1.4.0_3.5"
        ]
      },
      {
        "policyDefinitionReferenceId": "DeployNetworkWatcherWhenVirtualNetworksAreCreated",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a9b99dd8-06c5-4317-8629-9d86a3c6e7d9",
        "parameters": {},
        "groupNames": [
          "CIS_Azure_1.4.0_6.5"
        ]
      },
      {
        "policyDefinitionReferenceId": "[Preview]:ConfigurePeriodicCheckingForMissingSystemUpdatesOnAzureVirtualMachines",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/59efceea-0c96-497e-a4a1-4eb2290dac15",
        "parameters": {
          "assessmentMode": {
            "value": "[parameters('assessmentMode')]"
          },
          "osType": {
            "value": "[parameters('osType')]"
          },
          "locations": {
            "value": "[parameters('locations')]"
          },
          "tagValues": {
            "value": "[parameters('tagValues')]"
          },
          "tagOperator": {
            "value": "[parameters('tagOperator')]"
          }
        },
        "groupNames": [
          "CIS_Azure_1.4.0_7.5"
        ]
      },
      {
        "policyDefinitionReferenceId": "[Preview]:ScheduleRecurringUpdatesUsingUpdateManagementCenter",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ba0df93e-e4ac-479a-aac2-134bbae39a1a",
        "parameters": {
          "maintenanceConfigurationResourceId": {
            "value": "[parameters('maintenanceConfigurationResourceId')]"
          },
          "resourceGroups": {
            "value": "[parameters('resourceGroups')]"
          },
          "operatingSystemTypes": {
            "value": "[parameters('operatingSystemTypes')]"
          },
          "locations": {
            "value": "[parameters('locations')]"
          },
          "tagValues": {
            "value": "[parameters('arrtagValues')]"
          },
          "tagOperator": {
            "value": "[parameters('tagOperator')]"
          }
        },
        "groupNames": [
          "CIS_Azure_1.4.0_7.5"
        ]
      },
      {
        "policyDefinitionReferenceId": "ConfigureAzureDefenderForServersToBeEnabled",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/8e86a5b6-b9bd-49d1-8e21-4bb8a0862222",
        "parameters": {},
        "groupNames": [
          "CIS_Azure_1.4.0_7.6"
        ]
      },
      {
        "policyDefinitionReferenceId": "enable-soft-delete-and-purge-protection-on-Key-Vaults",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/<prefix>/providers/Microsoft.Authorization/policyDefinitions/enable-soft-delete-and-purge-protection-on-Key-Vaults",
        "parameters": {},
        "groupNames": [
          "CIS_Azure_1.4.0_8.6"
        ]
      },
      {
        "policyDefinitionReferenceId": "Configure-App-Service-apps-to-use-the latest-TLS-version",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ae44c1d1-0df2-4ca9-98fa-a3d3ae5b409d",
        "parameters": {},
        "groupNames": [
          "CIS_Azure_1.4.0_9.9"
        ]
      },
      {
        "policyDefinitionReferenceId": "Configure-Function-apps-to-use-the latest-TLS-version",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1f01f1c7-539c-49b5-9ef4-d4ffa37d22e0",
        "parameters": {},
        "groupNames": [
          "CIS_Azure_1.4.0_9.9"
        ]
      },
      {
        "policyDefinitionReferenceId": "Configure-Your-Storage-Account-Public-Access-to-be-disallowed",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/13502221-8df0-4414-9937-de9c5c4e396b",
        "parameters": {},
        "groupNames": [
          "CIS_Azure_1.4.0_5.1.3",
          "CIS_Azure_1.4.0_3.5"
        ]
      }
      ],
    "policyDefinitionGroups": [
        {
            "name": "CIS_Azure_1.4.0_1.1",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_1.1"
        },
        {
            "name": "CIS_Azure_1.4.0_1.3",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_1.3"
        },
        {
            "name": "CIS_Azure_1.4.0_2.13",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_2.13"
        },
        {
            "name": "CIS_Azure_1.4.0_2.14",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_2.14"
        },
        {
            "name": "CIS_Azure_1.4.0_2.15",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_2.15"
        },
        {
            "name": "CIS_Azure_1.4.0_3.5",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_3.5"
        },
        {
            "name": "CIS_Azure_1.4.0_4.3.2",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_4.3.2"
        },
        {
            "name": "CIS_Azure_1.4.0_4.3.3",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_4.3.3"
        },
        {
            "name": "CIS_Azure_1.4.0_4.3.4",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_4.3.4"
        },
        {
            "name": "CIS_Azure_1.4.0_4.3.5",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_4.3.5"
        },
        {
            "name": "CIS_Azure_1.4.0_5.1.3",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_5.1.3"
        },
        {
            "name": "CIS_Azure_1.4.0_6.5",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_6.5"
        },
        {
            "name": "CIS_Azure_1.4.0_7.4",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_7.4"
        },
        {
            "name": "CIS_Azure_1.4.0_7.5",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_7.5"
        },
        {
            "name": "CIS_Azure_1.4.0_7.6",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_7.6"
        },
        {
            "name": "CIS_Azure_1.4.0_8.1",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_8.1"
        },
        {
            "name": "CIS_Azure_1.4.0_8.2",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_8.2"
        },
        {
            "name": "CIS_Azure_1.4.0_8.3",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_8.3"
        },
        {
            "name": "CIS_Azure_1.4.0_8.4",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_8.4"
        },
        {
            "name": "CIS_Azure_1.4.0_8.6",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_8.6"
        },
        {
            "name": "CIS_Azure_1.4.0_9.6",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_9.6"
        },
        {
            "name": "CIS_Azure_1.4.0_9.7",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_9.7"
        },
        {
            "name": "CIS_Azure_1.4.0_9.8",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_9.8"
        },
        {
            "name": "CIS_Azure_1.4.0_9.9",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_9.9"
        }
    ]
  },
  "type": "Microsoft.Authorization/policySetDefinitions",
  "name": "Enforce CIS Implementation Group 1 Level 1 controls"
}