{
  "properties": {
    "displayName": "Enforce CIS Implementation Group 1 Level 2 controls",
    "policyType": "Custom",
    "description": "This policy initiative is a group of policies that Enforces CIS Implementation Group 1 Level 2 controls.",
    "metadata": {
      "version": "1.0",
      "category": "Regulatory Compliance"
    },
    "parameters": {
    "emailSecurityContact": {
        "type": "string",
        "metadata": {
          "displayName": "Security contacts email address",
          "description": "Provide email address for Microsoft Defender for Cloud contact details"
        }
      },
    "assessmentMode": {
        "type": "String",
        "metadata": {
          "displayName": "Assessment mode",
          "description": "Assessment mode for the machines."
        },
        "allowedValues": [
          "ImageDefault",
          "AutomaticByPlatform"
        ],
        "defaultValue": "AutomaticByPlatform"
      },
      "osType": {
        "type": "String",
        "metadata": {
          "displayName": "OS type",
          "description": "OS type for the machines."
        },
        "allowedValues": [
          "Windows",
          "Linux"
        ],
        "defaultValue": "Windows"
      },
      "operatingSystemTypes": {
        "type": "Array",
        "metadata": {
          "displayName": "Operating System types",
          "description": "The list of Operating System types from which machines need to be targeted."
        },
        "allowedValues": [
          "Windows",
          "Linux"
        ],
        "defaultValue": [
          "Windows",
          "Linux"
        ]
      },
    "locations": {
        "type": "Array",
        "metadata": {
          "displayName": "Machines locations",
          "description": "The list of locations from which machines need to be targeted.",
          "strongType": "location"
        },
        "defaultValue": []
      },
    "tagValues": {
        "type": "Object",
        "metadata": {
          "displayName": "Tags on machines",
          "description": "The list of tags that need to matched for getting target machines."
        },
        "defaultValue": {}
      },
        "arrtagValues": {
        "type": "Array",
        "metadata": {
          "displayName": "Tags on machines",
          "description": "The list of tags that need to matched for getting target machines (case sensitive). Example: [ {\"key\": \"tagKey1\", \"value\": \"value1\"}, {\"key\": \"tagKey2\", \"value\": \"value2\"}]."
        },
        "defaultValue": []
      },
    "tagOperator": {
        "type": "String",
        "metadata": {
          "displayName": "Tag operator",
          "description": "Matching condition for resource tags"
        },
        "allowedValues": [
          "All",
          "Any"
        ],
        "defaultValue": "Any"
      },
    "maintenanceConfigurationResourceId": {
        "type": "String",
        "metadata": {
          "displayName": "Maintenance Configuration ARM ID",
          "description": "ARM ID of Maintenance Configuration which will be used for scheduling.",
          "assignPermissions": true
        }
      },
   "resourceGroups": {
        "type": "Array",
        "metadata": {
          "displayName": "Resource groups",
          "description": "The list of resource groups from which machines need to be targeted. Example: [\"rg1\", \"rg2\"]."
        },
        "defaultValue": []
      }
    },
    "policyDefinitions":  [
      {
        "policyDefinitionReferenceId": "ConfigureAzureDefenderForServersToBeEnabled",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/8e86a5b6-b9bd-49d1-8e21-4bb8a0862222",
        "parameters": {},
        "groupNames": [
          "CIS_Azure_1.4.0_7.6"
        ]
      },
      {
        "policyDefinitionReferenceId": "ConfigureAzureDefenderForAppServiceToBeEnabled",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b40e7bcd-a1e5-47fe-b9cf-2f534d0bfb7d",
        "parameters": {},
        "groupNames": [
          "CIS_Azure_1.4.0_2.2"
        ]
      },
      {
        "policyDefinitionReferenceId": "ConfigureAzureDefenderForOpenSourceRelationalDatabasesToBeEnabled",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/44433aa3-7ec2-4002-93ea-65c65ff0310a",
        "parameters": {},
        "groupNames": [
          "CIS_Azure_1.4.0_2.3"
        ]
      },
      {
        "policyDefinitionReferenceId": "ConfigureAzureDefenderForAzureSqlDatabaseToBeEnabled",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b99b73e7-074b-4089-9395-b7236f094491",
        "parameters": {},
        "groupNames": [
          "CIS_Azure_1.4.0_2.3"
        ]
      },
      {
        "policyDefinitionReferenceId": "ConfigureAzureDefenderForSqlServersOnMachinesToBeEnabled",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/50ea7265-7d8c-429e-9a7d-ca1f410191c3",
        "parameters": {},
        "groupNames": [
          "CIS_Azure_1.4.0_2.4"
        ]
      },
      {
        "policyDefinitionReferenceId": "ConfigureAzureDefenderForStorageToBeEnabled",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/74c30959-af11-47b3-9ed2-a26e03f427a3",
        "parameters": {},
        "groupNames": [
          "CIS_Azure_1.4.0_2.5"
        ]
      },
      {
        "policyDefinitionReferenceId": "ConfigureMicrosoftDefenderForContainersToBeEnabled",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c9ddb292-b203-4738-aead-18e2716e858f",
        "parameters": {},
        "groupNames": [
          "CIS_Azure_1.4.0_2.6",
          "CIS_Azure_1.4.0_2.7"
        ]
      },
      {
        "policyDefinitionReferenceId": "ConfigureAzureDefenderForKeyVaultsToBeEnabled",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1f725891-01c0-420a-9059-4fa46cb770b7",
        "parameters": {},
        "groupNames": [
          "CIS_Azure_1.4.0_2.8"
        ]
      },
      {
        "policyDefinitionReferenceId": "ConfigureFunctionAppsToOnlyBeAccessibleOverHTTPS",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a096cbd0-4693-432f-9374-682f485f23f3",
        "parameters": {},
        "groupNames": [
          "CIS_Azure_1.4.0_9.1"
        ]
      },
      {
        "policyDefinitionReferenceId": "app-service_functionapp-enforce-client-certs-dine",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/<prefix>/providers/Microsoft.Authorization/policyDefinitions/app-service_functionapp-enforce-client-certs-dine",
        "parameters": {},
        "groupNames": [
          "CIS_Azure_1.4.0_9.1"
        ]
      }
      ],
    "policyDefinitionGroups": [
        {
            "name": "CIS_Azure_1.4.0_1.1",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_1.1"
        },
        {
            "name": "CIS_Azure_1.4.0_1.3",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_1.3"
        },
        {
            "name": "CIS_Azure_1.4.0_2.13",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_2.13"
        },
        {
            "name": "CIS_Azure_1.4.0_2.14",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_2.14"
        },
        {
            "name": "CIS_Azure_1.4.0_2.15",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_2.15"
        },
        {
            "name": "CIS_Azure_1.4.0_3.5",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_3.5"
        },
        {
            "name": "CIS_Azure_1.4.0_4.3.2",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_4.3.2"
        },
        {
            "name": "CIS_Azure_1.4.0_4.3.3",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_4.3.3"
        },
        {
            "name": "CIS_Azure_1.4.0_4.3.4",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_4.3.4"
        },
        {
            "name": "CIS_Azure_1.4.0_4.3.5",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_4.3.5"
        },
        {
            "name": "CIS_Azure_1.4.0_5.1.3",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_5.1.3"
        },
        {
            "name": "CIS_Azure_1.4.0_6.5",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_6.5"
        },
        {
            "name": "CIS_Azure_1.4.0_7.4",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_7.4"
        },
        {
            "name": "CIS_Azure_1.4.0_7.5",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_7.5"
        },
        {
            "name": "CIS_Azure_1.4.0_7.6",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_7.6"
        },
        {
            "name": "CIS_Azure_1.4.0_8.1",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_8.1"
        },
        {
            "name": "CIS_Azure_1.4.0_8.2",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_8.2"
        },
        {
            "name": "CIS_Azure_1.4.0_8.3",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_8.3"
        },
        {
            "name": "CIS_Azure_1.4.0_8.4",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_8.4"
        },
        {
            "name": "CIS_Azure_1.4.0_8.6",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_8.6"
        },
        {
            "name": "CIS_Azure_1.4.0_9.6",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_9.6"
        },
        {
            "name": "CIS_Azure_1.4.0_9.7",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_9.7"
        },
        {
            "name": "CIS_Azure_1.4.0_9.8",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_9.8"
        },
        {
            "name": "CIS_Azure_1.4.0_9.9",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_9.9"
        }
    ]
  },
  "type": "Microsoft.Authorization/policySetDefinitions",
  "name": "Enforce CIS Implementation Group 1 Level 1 controls"
}