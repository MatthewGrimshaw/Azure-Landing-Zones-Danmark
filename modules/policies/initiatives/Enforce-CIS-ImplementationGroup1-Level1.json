{
  "properties": {
    "displayName": "Enforce CIS Implementation Group 1 Level 1 controls",
    "policyType": "Custom",
    "description": "This policy initiative is a group of policies that Enforces CIS Implementation Group 1 Level 1 controls.",
    "metadata": {
      "version": "1.0",
      "category": "Regulatory Compliance"
    },
    "parameters": {
    "emailSecurityContact": {
        "type": "string",
        "metadata": {
          "displayName": "Security contacts email address",
          "description": "Provide email address for Microsoft Defender for Cloud contact details"
        }
      },
    "assessmentMode": {
        "type": "String",
        "metadata": {
          "displayName": "Assessment mode",
          "description": "Assessment mode for the machines."
        },
        "allowedValues": [
          "ImageDefault",
          "AutomaticByPlatform"
        ],
        "defaultValue": "AutomaticByPlatform"
      },
      "osType": {
        "type": "String",
        "metadata": {
          "displayName": "OS type",
          "description": "OS type for the machines."
        },
        "allowedValues": [
          "Windows",
          "Linux"
        ],
        "defaultValue": "Windows"
      },
      "operatingSystemTypes": {
        "type": "Array",
        "metadata": {
          "displayName": "Operating System types",
          "description": "The list of Operating System types from which machines need to be targeted."
        },
        "allowedValues": [
          "Windows",
          "Linux"
        ],
        "defaultValue": [
          "Windows",
          "Linux"
        ]
      },
    "locations": {
        "type": "Array",
        "metadata": {
          "displayName": "Machines locations",
          "description": "The list of locations from which machines need to be targeted.",
          "strongType": "location"
        },
        "defaultValue": []
      },
    "tagValues": {
        "type": "Object",
        "metadata": {
          "displayName": "Tags on machines",
          "description": "The list of tags that need to matched for getting target machines."
        },
        "defaultValue": {}
      },
    "tagOperator": {
        "type": "String",
        "metadata": {
          "displayName": "Tag operator",
          "description": "Matching condition for resource tags"
        },
        "allowedValues": [
          "All",
          "Any"
        ],
        "defaultValue": "Any"
      },
    "maintenanceConfigurationResourceId": {
        "type": "String",
        "metadata": {
          "displayName": "Maintenance Configuration ARM ID",
          "description": "ARM ID of Maintenance Configuration which will be used for scheduling.",
          "assignPermissions": true
        }
      },
   "resourceGroups": {
        "type": "Array",
        "metadata": {
          "displayName": "Resource groups",
          "description": "The list of resource groups from which machines need to be targeted. Example: [\"rg1\", \"rg2\"]."
        },
        "defaultValue": []
      }
    },
    "policyDefinitions":  [
      {
        "policyDefinitionReferenceId": "DeploySecurityContacts",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/<prefix>/providers/Microsoft.Authorization/policyDefinitions/Defender-Configure-Security-Contacts",
        "parameters": {
          "emailSecurityContact": {
            "value": "[parameters('emailSecurityContact')]"
          }
        },
        "groupNames": [
          "CIS_Azure_1.4.0_2.13"
        ]
      },
      {
        "policyDefinitionReferenceId": "ConfigureStorageAccountsToDisablePublicNetworkAccess",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a06d0189-92e8-4dba-b0c4-08d7669fce7d",
        "parameters": {},
        "groupNames": [
          "CIS_Azure_1.4.0_5.1.3",
          "CIS_Azure_1.4.0_3.5"
        ]
      },
      {
        "policyDefinitionReferenceId": "ConfigureYourStorageAccountPublicAccessToBeDisallowed",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/13502221-8df0-4414-9937-de9c5c4e396b",
        "parameters": {},
        "groupNames": [
          "CIS_Azure_1.4.0_5.1.3",
          "CIS_Azure_1.4.0_3.5"
        ]
      },
      {
        "policyDefinitionReferenceId": "DeployNetworkWatcherWhenVirtualNetworksAreCreated",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a9b99dd8-06c5-4317-8629-9d86a3c6e7d9",
        "parameters": {},
        "groupNames": [
          "CIS_Azure_1.4.0_6.5"
        ]
      },
      {
        "policyDefinitionReferenceId": "[Preview]:ConfigurePeriodicCheckingForMissingSystemUpdatesOnAzureVirtualMachines",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/59efceea-0c96-497e-a4a1-4eb2290dac15",
        "parameters": {
          "assessmentMode": {
            "value": "[parameters('assessmentMode')]"
          },
          "osType": {
            "value": "[parameters('osType')]"
          },
          "locations": {
            "value": "[parameters('locations')]"
          },
          "tagValues": {
            "value": "[parameters('tagValues')]"
          },
          "tagOperator": {
            "value": "[parameters('tagOperator')]"
          }
        },
        "groupNames": [
          "CIS_Azure_1.4.0_7.5"
        ]
      },
      {
        "policyDefinitionReferenceId": "[Preview]:ScheduleRecurringUpdatesUsingUpdateManagementCenter",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ba0df93e-e4ac-479a-aac2-134bbae39a1a",
        "parameters": {
          "maintenanceConfigurationResourceId": {
            "value": "[parameters('maintenanceConfigurationResourceId')]"
          },
          "resourceGroups": {
            "value": "[parameters('resourceGroups')]"
          },
          "operatingSystemTypes": {
            "value": "[parameters('operatingSystemTypes')]"
          },
          "locations": {
            "value": "[parameters('locations')]"
          },
          "tagValues": {
            "value": "[parameters('tagValues')]"
          },
          "tagOperator": {
            "value": "[parameters('tagOperator')]"
          }
        },
        "groupNames": [
          "CIS_Azure_1.4.0_7.5"
        ]
      },
      {
        "policyDefinitionReferenceId": "ConfigureAzureDefenderForServersToBeEnabled",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/8e86a5b6-b9bd-49d1-8e21-4bb8a0862222",
        "parameters": {},
        "groupNames": [
          "CIS_Azure_1.4.0_7.6"
        ]
      },
      {
        "policyDefinitionReferenceId": "enable-soft-delete-and-purge-protection-on-Key-Vaults",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/enable-soft-delete-and-purge-protection-on-Key-Vaults",
        "parameters": {},
        "groupNames": [
          "CIS_Azure_1.4.0_8.6"
        ]
      },
      {
        "policyDefinitionReferenceId": "Configure-App-Service-apps-to-use-the latest-TLS-version",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ae44c1d1-0df2-4ca9-98fa-a3d3ae5b409d",
        "parameters": {},
        "groupNames": [
          "CIS_Azure_1.4.0_9.9"
        ]
      },
      {
        "policyDefinitionReferenceId": "Configure-Function-apps-to-use-the latest-TLS-version",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1f01f1c7-539c-49b5-9ef4-d4ffa37d22e0",
        "parameters": {},
        "groupNames": [
          "CIS_Azure_1.4.0_9.9"
        ]
      },
      {
        "policyDefinitionReferenceId": "Configure-Your-Storage-Account-Public-Access-to-be-disallowed",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/13502221-8df0-4414-9937-de9c5c4e396b",
        "parameters": {},
        "groupNames": [
          "CIS_Azure_1.4.0_5.1.3",
          "CIS_Azure_1.4.0_3.5"
        ]
      }
      ],
    "policyDefinitionGroups": [
        {
            "name": "CIS_Azure_1.4.0_1.1",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_1.1"
        },
        {
            "name": "CIS_Azure_1.4.0_1.3",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_1.3"
        },
        {
            "name": "CIS_Azure_1.4.0_2.13",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_2.13"
        },
        {
            "name": "CIS_Azure_1.4.0_2.14",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_2.14"
        },
        {
            "name": "CIS_Azure_1.4.0_2.15",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_2.15"
        },
        {
            "name": "CIS_Azure_1.4.0_3.5",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_3.5"
        },
        {
            "name": "CIS_Azure_1.4.0_4.3.2",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_4.3.2"
        },
        {
            "name": "CIS_Azure_1.4.0_4.3.3",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_4.3.3"
        },
        {
            "name": "CIS_Azure_1.4.0_4.3.4",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_4.3.4"
        },
        {
            "name": "CIS_Azure_1.4.0_4.3.5",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_4.3.5"
        },
        {
            "name": "CIS_Azure_1.4.0_5.1.3",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_5.1.3"
        },
        {
            "name": "CIS_Azure_1.4.0_6.5",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_6.5"
        },
        {
            "name": "CIS_Azure_1.4.0_7.4",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_7.4"
        },
        {
            "name": "CIS_Azure_1.4.0_7.5",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_7.5"
        },
        {
            "name": "CIS_Azure_1.4.0_7.6",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_7.6"
        },
        {
            "name": "CIS_Azure_1.4.0_8.1",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_8.1"
        },
        {
            "name": "CIS_Azure_1.4.0_8.2",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_8.2"
        },
        {
            "name": "CIS_Azure_1.4.0_8.3",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_8.3"
        },
        {
            "name": "CIS_Azure_1.4.0_8.4",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_8.4"
        },
        {
            "name": "CIS_Azure_1.4.0_8.6",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_8.6"
        },
        {
            "name": "CIS_Azure_1.4.0_9.6",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_9.6"
        },
        {
            "name": "CIS_Azure_1.4.0_9.7",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_9.7"
        },
        {
            "name": "CIS_Azure_1.4.0_9.8",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_9.8"
        },
        {
            "name": "CIS_Azure_1.4.0_9.9",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_9.9"
        }
    ]
  },
  "type": "Microsoft.Authorization/policySetDefinitions",
  "name": "Enforce CIS Implementation Group 1 Level 1 controls"
}