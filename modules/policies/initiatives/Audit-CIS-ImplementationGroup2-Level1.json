{
  "properties": {
    "displayName": "Audit CIS Implementation Group 2 Level 1 controls",
    "policyType": "Custom",
    "description": "This policy initiative is a group of policies that Audit CIS Implementation Group 1 Level 2 controls.",
    "metadata": {
      "version": "1.0",
      "category": "App Service"
    },
    "parameters": {
        "effect-057ef27e-665e-4328-8ea3-04b3122bd9fb": {
            "type": "String",
            "defaultValue": "AuditIfNotExists",
            "allowedValues": [
                "AuditIfNotExists",
                "Disabled"
            ],
            "metadata": {
                "displayName": "Effect for policy: Resource logs in Azure Data Lake Store should be enabled",
                "description": "For more information about effects, visit https://aka.ms/policyeffects"
            }
        },
        "effect-0da106f2-4ca3-48e8-bc85-c638fe6aea8f": {
            "type": "String",
            "defaultValue": "AuditIfNotExists",
            "allowedValues": [
                "AuditIfNotExists",
                "Disabled"
            ],
            "metadata": {
                "displayName": "Effect for policy: Managed identity should be used in your Function App",
                "description": "For more information about effects, visit https://aka.ms/policyeffects"
            }
        },
        "effect-17k78e20-9358-41c9-923c-fb736d382a12": {
            "type": "String",
            "defaultValue": "AuditIfNotExists",
            "allowedValues": [
                "AuditIfNotExists",
                "Disabled"
            ],
            "metadata": {
                "displayName": "Effect for policy: Transparent Data Encryption on SQL databases should be enabled",
                "description": "For more information about effects, visit https://aka.ms/policyeffects"
            }
        },
        "effect-1f314764-cb73-4fc9-b863-8eca98ac36e9": {
            "type": "String",
            "defaultValue": "AuditIfNotExists",
            "allowedValues": [
                "AuditIfNotExists",
                "Disabled"
            ],
            "metadata": {
                "displayName": "Effect for policy: An Azure Active Directory administrator should be provisioned for SQL servers",
                "description": "For more information about effects, visit https://aka.ms/policyeffects"
            }
        },
        "effect-24fba194-95d6-48c0-aea7-f65bf859c598": {
            "type": "String",
            "defaultValue": "Audit",
            "allowedValues": [
                "Audit",
                "Deny",
                "Disabled"
            ],
            "metadata": {
                "displayName": "Effect for policy: Enable infrastructure encryption for Azure Database for PostgreSQL servers to have higher level of assurance that the data is secure.",
                "description": "For more information about effects, visit https://aka.ms/policyeffects"
            }
        },
        "effect-2b9ad585-36bc-4615-b300-fd4435808332": {
            "type": "String",
            "defaultValue": "AuditIfNotExists",
            "allowedValues": [
                "AuditIfNotExists",
                "Disabled"
            ],
            "metadata": {
                "displayName": "Effect for policy: Managed identity should be used in your Web App",
                "description": "For more information about effects, visit https://aka.ms/policyeffects"
            }
        },
        "effect-34f95f76-5386-4de7-b824-0d8478470c9d": {
            "type": "String",
            "defaultValue": "AuditIfNotExists",
            "allowedValues": [
                "AuditIfNotExists",
                "Disabled"
            ],
            "metadata": {
                "displayName": "Effect for policy: Resource logs in Logic Apps should be enabled",
                "description": "For more information about effects, visit https://aka.ms/policyeffects"
            }
        },
        "effect-383856f8-de7f-44a2-81fc-e5135b5c2aa4": {
            "type": "String",
            "defaultValue": "AuditIfNotExists",
            "allowedValues": [
                "AuditIfNotExists",
                "Disabled"
            ],
            "metadata": {
                "displayName": "Effect for policy: Resource logs in IoT Hub should be enabled",
                "description": "For more information about effects, visit https://aka.ms/policyeffects"
            }
        },
        "effect-399b2637-a50f-4f95-96f8-3a145476eb15": {
            "type": "String",
            "defaultValue": "AuditIfNotExists",
            "allowedValues": [
                "AuditIfNotExists",
                "Disabled"
            ],
            "metadata": {
                "displayName": "Effect for policy: FTPS only should be required in your Function App",
                "description": "For more information about effects, visit https://aka.ms/policyeffects"
            }
        },
        "effect-3b980d31-7904-4bb7-8575-5665739a8052-MicrosoftSecurity-securitySolutions-delete": {
            "type": "String",
            "defaultValue": "AuditIfNotExists",
            "allowedValues": [
                "AuditIfNotExists",
                "Disabled"
            ],
            "metadata": {
                "displayName": "Effect for policy: An activity log alert should exist for specific Security operations (Microsoft.Security/securitySolutions/delete)",
                "description": "For more information about effects, visit https://aka.ms/policyeffects"
            }
        },
        "effect-3b980d31-7904-4bb7-8575-5665739a8052-MicrosoftSecurity-securitySolutions-write": {
            "type": "String",
            "defaultValue": "AuditIfNotExists",
            "allowedValues": [
                "AuditIfNotExists",
                "Disabled"
            ],
            "metadata": {
                "displayName": "Effect for policy: An activity log alert should exist for specific Security operations (Microsoft.Security/securitySolutions/write)",
                "description": "For more information about effects, visit https://aka.ms/policyeffects"
            }
        },
        "effect-428256e6-1fac-4f48-a757-df34c2b3336d": {
            "type": "String",
            "defaultValue": "AuditIfNotExists",
            "allowedValues": [
                "AuditIfNotExists",
                "Disabled"
            ],
            "metadata": {
                "displayName": "Effect for policy: Resource logs in Batch accounts should be enabled",
                "description": "For more information about effects, visit https://aka.ms/policyeffects"
            }
        },
        "effect-475aae12-b88a-4572-8b36-9b712b2b3a17": {
            "type": "String",
            "defaultValue": "AuditIfNotExists",
            "allowedValues": [
                "AuditIfNotExists",
                "Disabled"
            ],
            "metadata": {
                "displayName": "Effect for policy: Auto provisioning of the Log Analytics agent should be enabled on your subscription",
                "description": "For more information about effects, visit https://aka.ms/policyeffects"
            }
        },
        "effect-4d24b6d4-5e53-4a4f-a7f4-618fa573ee4b": {
            "type": "String",
            "defaultValue": "AuditIfNotExists",
            "allowedValues": [
                "AuditIfNotExists",
                "Disabled"
            ],
            "metadata": {
                "displayName": "Effect for policy: FTPS should be required in your Web App",
                "description": "For more information about effects, visit https://aka.ms/policyeffects"
            }
        },
        "effect-7c1b1214-f927-48bf-8882-84f0af6588b1": {
            "type": "String",
            "defaultValue": "AuditIfNotExists",
            "allowedValues": [
                "AuditIfNotExists",
                "Disabled"
            ],
            "metadata": {
                "displayName": "Effect for policy: Resource logs in Virtual Machine Scale Sets should be enabled",
                "description": "For more information about effects, visit https://aka.ms/policyeffects"
            }
        },
        "effect-83a214f7-d01a-484b-91a9-ed54470c9a6a": {
            "type": "String",
            "defaultValue": "AuditIfNotExists",
            "allowedValues": [
                "AuditIfNotExists",
                "Disabled"
            ],
            "metadata": {
                "displayName": "Effect for policy: Resource logs in Event Hub should be enabled",
                "description": "For more information about effects, visit https://aka.ms/policyeffects"
            }
        },
        "effect-89099bee-89e0-4b26-a5f4-165451757743": {
            "type": "String",
            "defaultValue": "AuditIfNotExists",
            "allowedValues": [
                "AuditIfNotExists",
                "Disabled"
            ],
            "metadata": {
                "displayName": "Effect for policy: SQL servers should be configured with 90 days auditing retention or higher.",
                "description": "For more information about effects, visit https://aka.ms/policyeffects"
            }
        },
        "effect-91a78b24-f231-4a8a-8da9-02c35b2b6510": {
            "type": "String",
            "defaultValue": "AuditIfNotExists",
            "allowedValues": [
                "AuditIfNotExists",
                "Disabled"
            ],
            "metadata": {
                "displayName": "Effect for policy: Resource logs in App Services should be enabled",
                "description": "For more information about effects, visit https://aka.ms/policyeffects"
            }
        },
        "effect-a4af4a39-4135-47fb-b175-47fbdf85311d": {
            "type": "String",
            "defaultValue": "Audit",
            "allowedValues": [
                "Audit",
                "Disabled"
            ],
            "metadata": {
                "displayName": "Effect for policy: Web Application should only be accessible over HTTPS",
                "description": "For more information about effects, visit https://aka.ms/policyeffects"
            }
        },
        "effect-a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9": {
            "type": "String",
            "defaultValue": "AuditIfNotExists",
            "allowedValues": [
                "AuditIfNotExists",
                "Disabled"
            ],
            "metadata": {
                "displayName": "Effect for policy: Auditing on SQL server should be enabled",
                "description": "For more information about effects, visit https://aka.ms/policyeffects"
            }
        },
        "effect-b4330a05-a843-4bc8-bf9a-cacce50c67f4": {
            "type": "String",
            "defaultValue": "AuditIfNotExists",
            "allowedValues": [
                "AuditIfNotExists",
                "Disabled"
            ],
            "metadata": {
                "displayName": "Effect for policy: Resource logs in Search services should be enabled",
                "description": "For more information about effects, visit https://aka.ms/policyeffects"
            }
        },
        "effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftNetwork-networkSecurityGroups-delete": {
            "type": "String",
            "defaultValue": "AuditIfNotExists",
            "allowedValues": [
                "AuditIfNotExists",
                "Disabled"
            ],
            "metadata": {
                "displayName": "Effect for policy: An activity log alert should exist for specific Administrative operations (Microsoft.Network/networkSecurityGroups/delete)",
                "description": "For more information about effects, visit https://aka.ms/policyeffects"
            }
        },
        "effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftNetwork-networkSecurityGroups-securityRules-delete": {
            "type": "String",
            "defaultValue": "AuditIfNotExists",
            "allowedValues": [
                "AuditIfNotExists",
                "Disabled"
            ],
            "metadata": {
                "displayName": "Effect for policy: An activity log alert should exist for specific Administrative operations (Microsoft.Network/networkSecurityGroups/securityRules/delete)",
                "description": "For more information about effects, visit https://aka.ms/policyeffects"
            }
        },
        "effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftNetwork-networkSecurityGroups-securityRules-write": {
            "type": "String",
            "defaultValue": "AuditIfNotExists",
            "allowedValues": [
                "AuditIfNotExists",
                "Disabled"
            ],
            "metadata": {
                "displayName": "Effect for policy: An activity log alert should exist for specific Administrative operations (Microsoft.Network/networkSecurityGroups/securityRules/write)",
                "description": "For more information about effects, visit https://aka.ms/policyeffects"
            }
        },
        "effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftNetwork-networkSecurityGroups-write": {
            "type": "String",
            "defaultValue": "AuditIfNotExists",
            "allowedValues": [
                "AuditIfNotExists",
                "Disabled"
            ],
            "metadata": {
                "displayName": "Effect for policy: An activity log alert should exist for specific Administrative operations (Microsoft.Network/networkSecurityGroups/write)",
                "description": "For more information about effects, visit https://aka.ms/policyeffects"
            }
        },
        "effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftSql-servers-firewallRules-delete": {
            "type": "String",
            "defaultValue": "AuditIfNotExists",
            "allowedValues": [
                "AuditIfNotExists",
                "Disabled"
            ],
            "metadata": {
                "displayName": "Effect for policy: An activity log alert should exist for specific Administrative operations (Microsoft.Sql/servers/firewallRules/delete)",
                "description": "For more information about effects, visit https://aka.ms/policyeffects"
            }
        },
        "effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftSql-servers-firewallRules-write": {
            "type": "String",
            "defaultValue": "AuditIfNotExists",
            "allowedValues": [
                "AuditIfNotExists",
                "Disabled"
            ],
            "metadata": {
                "displayName": "Effect for policy: An activity log alert should exist for specific Administrative operations (Microsoft.Sql/servers/firewallRules/write)",
                "description": "For more information about effects, visit https://aka.ms/policyeffects"
            }
        },
        "effect-c5447c04-a4d7-4ba8-a263-c9ee321a6858-MicrosoftAuthorization-policyAssignments-delete": {
            "type": "String",
            "defaultValue": "AuditIfNotExists",
            "allowedValues": [
                "AuditIfNotExists",
                "Disabled"
            ],
            "metadata": {
                "displayName": "Effect for policy: An activity log alert should exist for specific Policy operations (Microsoft.Authorization/policyAssignments/delete)",
                "description": "For more information about effects, visit https://aka.ms/policyeffects"
            }
        },
        "effect-c95c74d9-38fe-4f0d-af86-0c7d626a315c": {
            "type": "String",
            "defaultValue": "AuditIfNotExists",
            "allowedValues": [
                "AuditIfNotExists",
                "Disabled"
            ],
            "metadata": {
                "displayName": "Effect for policy: Resource logs in Data Lake Analytics should be enabled",
                "description": "For more information about effects, visit https://aka.ms/policyeffects"
            }
        },
        "effect-cf820ca0-f99e-4f3e-84fb-66e913812d21": {
            "type": "String",
            "defaultValue": "AuditIfNotExists",
            "allowedValues": [
                "AuditIfNotExists",
                "Disabled"
            ],
            "metadata": {
                "displayName": "Effect for policy: Resource logs in Key Vault should be enabled",
                "description": "For more information about effects, visit https://aka.ms/policyeffects"
            }
        },
        "effect-f0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b": {
            "type": "String",
            "defaultValue": "AuditIfNotExists",
            "allowedValues": [
                "AuditIfNotExists",
                "Disabled"
            ],
            "metadata": {
                "displayName": "Effect for policy: Latest TLS version should be used in your Web App",
                "description": "For more information about effects, visit https://aka.ms/policyeffects"
            }
        },
        "effect-f8d36e2f-389b-4ee4-898d-21aeb69a0f45": {
            "type": "String",
            "defaultValue": "AuditIfNotExists",
            "allowedValues": [
                "AuditIfNotExists",
                "Disabled"
            ],
            "metadata": {
                "displayName": "Effect for policy: Resource logs in Service Bus should be enabled",
                "description": "For more information about effects, visit https://aka.ms/policyeffects"
            }
        },
        "effect-f9be5368-9bf5-4b84-9e0a-7850da98bb46": {
            "type": "String",
            "defaultValue": "AuditIfNotExists",
            "allowedValues": [
                "AuditIfNotExists",
                "Disabled"
            ],
            "metadata": {
                "displayName": "Effect for policy: Resource logs in Azure Stream Analytics should be enabled",
                "description": "For more information about effects, visit https://aka.ms/policyeffects"
            }
        },
        "effect-f9d614c5-c173-4d56-95a7-b4437057d193": {
            "type": "String",
            "defaultValue": "AuditIfNotExists",
            "allowedValues": [
                "AuditIfNotExists",
                "Disabled"
            ],
            "metadata": {
                "displayName": "Effect for policy: Latest TLS version should be used in your Function App",
                "description": "For more information about effects, visit https://aka.ms/policyeffects"
            }
        },
        "effect-fe83a0eb-a853-422d-aac2-1bffd182c5d0": {
            "type": "String",
            "defaultValue": "Audit",
            "allowedValues": [
                "Audit",
                "Deny",
                "Disabled"
            ],
            "metadata": {
                "displayName": "Effect for policy: Storage accounts should have the specified minimum TLS version",
                "description": "For more information about effects, visit https://aka.ms/policyeffects"
            }
        },
        "includeAKSClusters-7c1b1214-f927-48bf-8882-84f0af6588b1": {
            "type": "Boolean",
            "defaultValue": false,
            "metadata": {
                "displayName": "Include AKS clusters when auditing if virtual machine scale set resource logs are enabled"
            }
        },
        "requiredRetentionDays": {
            "type": "String",
            "defaultValue": "365",
            "metadata": {
                "displayName": "Required retention period (days) for resource logs",
                "description": "For more information about resource logs, visit https://aka.ms/resourcelogs"
            }
        },
        "setting-a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9": {
            "type": "String",
            "defaultValue": "enabled",
            "allowedValues": [
                "enabled",
                "disabled"
            ],
            "metadata": {
                "displayName": "Required auditing setting for SQL servers"
            }
        }
    },
    "policyDefinitions":[
        {
            "policyDefinitionReferenceId": "475aae12-b88a-4572-8b36-9b712b2b3a17",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/475aae12-b88a-4572-8b36-9b712b2b3a17",
            "parameters": {
                "effect": {
                    "value": "[parameters('effect-475aae12-b88a-4572-8b36-9b712b2b3a17')]"
                }
            },
            "groupNames": [
                "CIS_Azure_1.4.0_2.11"
            ]
        },
        {
            "policyDefinitionReferenceId": "a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9",
            "parameters": {
                "effect": {
                    "value": "[parameters('effect-a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9')]"
                },
                "setting": {
                    "value": "[parameters('setting-a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9')]"
                }
            },
            "groupNames": [
                "CIS_Azure_1.4.0_4.1.1"
            ]
        },
        {
            "policyDefinitionReferenceId": "17k78e20-9358-41c9-923c-fb736d382a12",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/17k78e20-9358-41c9-923c-fb736d382a12",
            "parameters": {
                "effect": {
                    "value": "[parameters('effect-17k78e20-9358-41c9-923c-fb736d382a12')]"
                }
            },
            "groupNames": [
                "CIS_Azure_1.4.0_4.1.2"
            ]
        },
        {
            "policyDefinitionReferenceId": "89099bee-89e0-4b26-a5f4-165451757743",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/89099bee-89e0-4b26-a5f4-165451757743",
            "parameters": {
                "effect": {
                    "value": "[parameters('effect-89099bee-89e0-4b26-a5f4-165451757743')]"
                }
            },
            "groupNames": [
                "CIS_Azure_1.4.0_4.1.3"
            ]
        },
        {
            "policyDefinitionReferenceId": "1f314764-cb73-4fc9-b863-8eca98ac36e9",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1f314764-cb73-4fc9-b863-8eca98ac36e9",
            "parameters": {
                "effect": {
                    "value": "[parameters('effect-1f314764-cb73-4fc9-b863-8eca98ac36e9')]"
                }
            },
            "groupNames": [
                "CIS_Azure_1.4.0_4.5"
            ]
        },
        {
            "policyDefinitionReferenceId": "cf820ca0-f99e-4f3e-84fb-66e913812d21",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21",
            "parameters": {
                "effect": {
                    "value": "[parameters('effect-cf820ca0-f99e-4f3e-84fb-66e913812d21')]"
                },
                "requiredRetentionDays": {
                    "value": "[parameters('requiredRetentionDays')]"
                }
            },
            "groupNames": [
                "CIS_Azure_1.4.0_5.1.5",
                "CIS_Azure_1.4.0_5.3"
            ]
        },
        {
            "policyDefinitionReferenceId": "c5447c04-a4d7-4ba8-a263-c9ee321a6858-1",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c5447c04-a4d7-4ba8-a263-c9ee321a6858",
            "parameters": {
                "effect": {
                    "value": "[parameters('effect-c5447c04-a4d7-4ba8-a263-c9ee321a6858-MicrosoftAuthorization-policyAssignments-delete')]"
                },
                "operationName": {
                    "value": "Microsoft.Authorization/policyAssignments/delete"
                }
            },
            "groupNames": [
                "CIS_Azure_1.4.0_5.2.2"
            ]
        },
        {
            "policyDefinitionReferenceId": "b954148f-4c11-4c38-8221-be76711e194a-0",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b954148f-4c11-4c38-8221-be76711e194a",
            "parameters": {
                "effect": {
                    "value": "[parameters('effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftNetwork-networkSecurityGroups-write')]"
                },
                "operationName": {
                    "value": "Microsoft.Network/networkSecurityGroups/write"
                }
            },
            "groupNames": [
                "CIS_Azure_1.4.0_5.2.3"
            ]
        },
        {
            "policyDefinitionReferenceId": "b954148f-4c11-4c38-8221-be76711e194a-1",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b954148f-4c11-4c38-8221-be76711e194a",
            "parameters": {
                "effect": {
                    "value": "[parameters('effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftNetwork-networkSecurityGroups-delete')]"
                },
                "operationName": {
                    "value": "Microsoft.Network/networkSecurityGroups/delete"
                }
            },
            "groupNames": [
                "CIS_Azure_1.4.0_5.2.4"
            ]
        },
        {
            "policyDefinitionReferenceId": "b954148f-4c11-4c38-8221-be76711e194a-2",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b954148f-4c11-4c38-8221-be76711e194a",
            "parameters": {
                "effect": {
                    "value": "[parameters('effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftNetwork-networkSecurityGroups-securityRules-write')]"
                },
                "operationName": {
                    "value": "Microsoft.Network/networkSecurityGroups/securityRules/write"
                }
            },
            "groupNames": [
                "CIS_Azure_1.4.0_5.2.5"
            ]
        },
        {
            "policyDefinitionReferenceId": "b954148f-4c11-4c38-8221-be76711e194a-3",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b954148f-4c11-4c38-8221-be76711e194a",
            "parameters": {
                "effect": {
                    "value": "[parameters('effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftNetwork-networkSecurityGroups-securityRules-delete')]"
                },
                "operationName": {
                    "value": "Microsoft.Network/networkSecurityGroups/securityRules/delete"
                }
            },
            "groupNames": [
                "CIS_Azure_1.4.0_5.2.6"
            ]
        },
        {
            "policyDefinitionReferenceId": "3b980d31-7904-4bb7-8575-5665739a8052-0",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/3b980d31-7904-4bb7-8575-5665739a8052",
            "parameters": {
                "effect": {
                    "value": "[parameters('effect-3b980d31-7904-4bb7-8575-5665739a8052-MicrosoftSecurity-securitySolutions-write')]"
                },
                "operationName": {
                    "value": "Microsoft.Security/securitySolutions/write"
                }
            },
            "groupNames": [
                "CIS_Azure_1.4.0_5.2.7"
            ]
        },
        {
            "policyDefinitionReferenceId": "3b980d31-7904-4bb7-8575-5665739a8052-1",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/3b980d31-7904-4bb7-8575-5665739a8052",
            "parameters": {
                "effect": {
                    "value": "[parameters('effect-3b980d31-7904-4bb7-8575-5665739a8052-MicrosoftSecurity-securitySolutions-delete')]"
                },
                "operationName": {
                    "value": "Microsoft.Security/securitySolutions/delete"
                }
            },
            "groupNames": [
                "CIS_Azure_1.4.0_5.2.8"
            ]
        },
        {
            "policyDefinitionReferenceId": "b954148f-4c11-4c38-8221-be76711e194a-4",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b954148f-4c11-4c38-8221-be76711e194a",
            "parameters": {
                "effect": {
                    "value": "[parameters('effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftSql-servers-firewallRules-write')]"
                },
                "operationName": {
                    "value": "Microsoft.Sql/servers/firewallRules/write"
                }
            },
            "groupNames": [
                "CIS_Azure_1.4.0_5.2.9"
            ]
        },
        {
            "policyDefinitionReferenceId": "b954148f-4c11-4c38-8221-be76711e194a-5",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b954148f-4c11-4c38-8221-be76711e194a",
            "parameters": {
                "effect": {
                    "value": "[parameters('effect-b954148f-4c11-4c38-8221-be76711e194a-MicrosoftSql-servers-firewallRules-delete')]"
                },
                "operationName": {
                    "value": "Microsoft.Sql/servers/firewallRules/delete"
                }
            },
            "groupNames": [
                "CIS_Azure_1.4.0_5.2.9"
            ]
        },
        {
            "policyDefinitionReferenceId": "91a78b24-f231-4a8a-8da9-02c35b2b6510",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/91a78b24-f231-4a8a-8da9-02c35b2b6510",
            "parameters": {
                "effect": {
                    "value": "[parameters('effect-91a78b24-f231-4a8a-8da9-02c35b2b6510')]"
                }
            },
            "groupNames": [
                "CIS_Azure_1.4.0_5.3"
            ]
        },
        {
            "policyDefinitionReferenceId": "428256e6-1fac-4f48-a757-df34c2b3336d",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/428256e6-1fac-4f48-a757-df34c2b3336d",
            "parameters": {
                "effect": {
                    "value": "[parameters('effect-428256e6-1fac-4f48-a757-df34c2b3336d')]"
                },
                "requiredRetentionDays": {
                    "value": "[parameters('requiredRetentionDays')]"
                }
            },
            "groupNames": [
                "CIS_Azure_1.4.0_5.3"
            ]
        },
        {
            "policyDefinitionReferenceId": "7c1b1214-f927-48bf-8882-84f0af6588b1",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/7c1b1214-f927-48bf-8882-84f0af6588b1",
            "parameters": {
                "effect": {
                    "value": "[parameters('effect-7c1b1214-f927-48bf-8882-84f0af6588b1')]"
                },
                "includeAKSClusters": {
                    "value": "[parameters('includeAKSClusters-7c1b1214-f927-48bf-8882-84f0af6588b1')]"
                }
            },
            "groupNames": [
                "CIS_Azure_1.4.0_5.3"
            ]
        },
        {
            "policyDefinitionReferenceId": "057ef27e-665e-4328-8ea3-04b3122bd9fb",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/057ef27e-665e-4328-8ea3-04b3122bd9fb",
            "parameters": {
                "effect": {
                    "value": "[parameters('effect-057ef27e-665e-4328-8ea3-04b3122bd9fb')]"
                },
                "requiredRetentionDays": {
                    "value": "[parameters('requiredRetentionDays')]"
                }
            },
            "groupNames": [
                "CIS_Azure_1.4.0_5.3"
            ]
        },
        {
            "policyDefinitionReferenceId": "c95c74d9-38fe-4f0d-af86-0c7d626a315c",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c95c74d9-38fe-4f0d-af86-0c7d626a315c",
            "parameters": {
                "effect": {
                    "value": "[parameters('effect-c95c74d9-38fe-4f0d-af86-0c7d626a315c')]"
                },
                "requiredRetentionDays": {
                    "value": "[parameters('requiredRetentionDays')]"
                }
            },
            "groupNames": [
                "CIS_Azure_1.4.0_5.3"
            ]
        },
        {
            "policyDefinitionReferenceId": "83a214f7-d01a-484b-91a9-ed54470c9a6a",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/83a214f7-d01a-484b-91a9-ed54470c9a6a",
            "parameters": {
                "effect": {
                    "value": "[parameters('effect-83a214f7-d01a-484b-91a9-ed54470c9a6a')]"
                },
                "requiredRetentionDays": {
                    "value": "[parameters('requiredRetentionDays')]"
                }
            },
            "groupNames": [
                "CIS_Azure_1.4.0_5.3"
            ]
        },
        {
            "policyDefinitionReferenceId": "383856f8-de7f-44a2-81fc-e5135b5c2aa4",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/383856f8-de7f-44a2-81fc-e5135b5c2aa4",
            "parameters": {
                "effect": {
                    "value": "[parameters('effect-383856f8-de7f-44a2-81fc-e5135b5c2aa4')]"
                },
                "requiredRetentionDays": {
                    "value": "[parameters('requiredRetentionDays')]"
                }
            },
            "groupNames": [
                "CIS_Azure_1.4.0_5.3"
            ]
        },
        {
            "policyDefinitionReferenceId": "34f95f76-5386-4de7-b824-0d8478470c9d",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/34f95f76-5386-4de7-b824-0d8478470c9d",
            "parameters": {
                "effect": {
                    "value": "[parameters('effect-34f95f76-5386-4de7-b824-0d8478470c9d')]"
                },
                "requiredRetentionDays": {
                    "value": "[parameters('requiredRetentionDays')]"
                }
            },
            "groupNames": [
                "CIS_Azure_1.4.0_5.3"
            ]
        },
        {
            "policyDefinitionReferenceId": "b4330a05-a843-4bc8-bf9a-cacce50c67f4",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b4330a05-a843-4bc8-bf9a-cacce50c67f4",
            "parameters": {
                "effect": {
                    "value": "[parameters('effect-b4330a05-a843-4bc8-bf9a-cacce50c67f4')]"
                },
                "requiredRetentionDays": {
                    "value": "[parameters('requiredRetentionDays')]"
                }
            },
            "groupNames": [
                "CIS_Azure_1.4.0_5.3"
            ]
        },
        {
            "policyDefinitionReferenceId": "f8d36e2f-389b-4ee4-898d-21aeb69a0f45",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f8d36e2f-389b-4ee4-898d-21aeb69a0f45",
            "parameters": {
                "effect": {
                    "value": "[parameters('effect-f8d36e2f-389b-4ee4-898d-21aeb69a0f45')]"
                },
                "requiredRetentionDays": {
                    "value": "[parameters('requiredRetentionDays')]"
                }
            },
            "groupNames": [
                "CIS_Azure_1.4.0_5.3"
            ]
        },
        {
            "policyDefinitionReferenceId": "f9be5368-9bf5-4b84-9e0a-7850da98bb46",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f9be5368-9bf5-4b84-9e0a-7850da98bb46",
            "parameters": {
                "effect": {
                    "value": "[parameters('effect-f9be5368-9bf5-4b84-9e0a-7850da98bb46')]"
                },
                "requiredRetentionDays": {
                    "value": "[parameters('requiredRetentionDays')]"
                }
            },
            "groupNames": [
                "CIS_Azure_1.4.0_5.3"
            ]
        },
        {
            "policyDefinitionReferenceId": "a4af4a39-4135-47fb-b175-47fbdf85311d",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a4af4a39-4135-47fb-b175-47fbdf85311d",
            "parameters": {
                "effect": {
                    "value": "[parameters('effect-a4af4a39-4135-47fb-b175-47fbdf85311d')]"
                }
            },
            "groupNames": [
                "CIS_Azure_1.4.0_9.2"
            ]
        },
        {
            "policyDefinitionReferenceId": "f9d614c5-c173-4d56-95a7-b4437057d193",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f9d614c5-c173-4d56-95a7-b4437057d193",
            "parameters": {
                "effect": {
                    "value": "[parameters('effect-f9d614c5-c173-4d56-95a7-b4437057d193')]"
                }
            },
            "groupNames": [
                "CIS_Azure_1.4.0_9.3"
            ]
        },
        {
            "policyDefinitionReferenceId": "f0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b",
            "parameters": {
                "effect": {
                    "value": "[parameters('effect-f0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b')]"
                }
            },
            "groupNames": [
                "CIS_Azure_1.4.0_9.3"
            ]
        },
        {
            "policyDefinitionReferenceId": "0da106f2-4ca3-48e8-bc85-c638fe6aea8f",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0da106f2-4ca3-48e8-bc85-c638fe6aea8f",
            "parameters": {
                "effect": {
                    "value": "[parameters('effect-0da106f2-4ca3-48e8-bc85-c638fe6aea8f')]"
                }
            },
            "groupNames": [
                "CIS_Azure_1.4.0_9.5"
            ]
        },
        {
            "policyDefinitionReferenceId": "2b9ad585-36bc-4615-b300-fd4435808332",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2b9ad585-36bc-4615-b300-fd4435808332",
            "parameters": {
                "effect": {
                    "value": "[parameters('effect-2b9ad585-36bc-4615-b300-fd4435808332')]"
                }
            },
            "groupNames": [
                "CIS_Azure_1.4.0_9.5"
            ]
        },
        {
            "policyDefinitionReferenceId": "399b2637-a50f-4f95-96f8-3a145476eb15",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/399b2637-a50f-4f95-96f8-3a145476eb15",
            "parameters": {
                "effect": {
                    "value": "[parameters('effect-399b2637-a50f-4f95-96f8-3a145476eb15')]"
                }
            },
            "groupNames": [
                "CIS_Azure_1.4.0_9.10"
            ]
        },
        {
            "policyDefinitionReferenceId": "4d24b6d4-5e53-4a4f-a7f4-618fa573ee4b",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/4d24b6d4-5e53-4a4f-a7f4-618fa573ee4b",
            "parameters": {
                "effect": {
                    "value": "[parameters('effect-4d24b6d4-5e53-4a4f-a7f4-618fa573ee4b')]"
                }
            },
            "groupNames": [
                "CIS_Azure_1.4.0_9.10"
            ]
        },
        {
            "policyDefinitionReferenceId": "fe83a0eb-a853-422d-aac2-1bffd182c5d0",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/fe83a0eb-a853-422d-aac2-1bffd182c5d0",
            "parameters": {
                "effect": {
                    "value": "[parameters('effect-fe83a0eb-a853-422d-aac2-1bffd182c5d0')]"
                }
            },
            "groupNames": [
                "CIS_Azure_1.4.0_3.12"
            ]
        },
        {
            "policyDefinitionReferenceId": "24fba194-95d6-48c0-aea7-f65bf859c598",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/24fba194-95d6-48c0-aea7-f65bf859c598",
            "parameters": {
                "effect": {
                    "value": "[parameters('effect-24fba194-95d6-48c0-aea7-f65bf859c598')]"
                }
            },
            "groupNames": [
                "CIS_Azure_1.4.0_4.3.8"
            ]
        }
    ],
    "policyDefinitionGroups": [
        {
            "name": "CIS_Azure_1.4.0_2.11",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_2.11"
        },
        {
            "name": "CIS_Azure_1.4.0_3.12",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_3.12"
        },
        {
            "name": "CIS_Azure_1.4.0_4.1.1",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_4.1.1"
        },
        {
            "name": "CIS_Azure_1.4.0_4.1.2",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_4.1.2"
        },
        {
            "name": "CIS_Azure_1.4.0_4.1.3",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_4.1.3"
        },
        {
            "name": "CIS_Azure_1.4.0_4.3.8",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_4.3.8"
        },
        {
            "name": "CIS_Azure_1.4.0_4.5",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_4.5"
        },
        {
            "name": "CIS_Azure_1.4.0_5.2.2",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_5.2.2"
        },
        {
            "name": "CIS_Azure_1.4.0_5.2.3",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_5.2.3"
        },
        {
            "name": "CIS_Azure_1.4.0_5.2.4",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_5.2.4"
        },
        {
            "name": "CIS_Azure_1.4.0_5.2.5",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_5.2.5"
        },
        {
            "name": "CIS_Azure_1.4.0_5.2.6",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_5.2.6"
        },
        {
            "name": "CIS_Azure_1.4.0_5.2.7",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_5.2.7"
        },
        {
            "name": "CIS_Azure_1.4.0_5.2.8",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_5.2.8"
        },
        {
            "name": "CIS_Azure_1.4.0_5.2.9",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_5.2.9"
        },
        {
            "name": "CIS_Azure_1.4.0_5.1.5",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_5.1.5"
        },
        {
            "name": "CIS_Azure_1.4.0_5.3",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_5.3"
        },
        {
            "name": "CIS_Azure_1.4.0_9.2",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_9.2"
        },
        {
            "name": "CIS_Azure_1.4.0_9.3",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_9.3"
        },
        {
            "name": "CIS_Azure_1.4.0_9.5",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_9.5"
        },
        {
            "name": "CIS_Azure_1.4.0_9.10",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_9.10"
        }
    ]
  },
  "type": "Microsoft.Authorization/policySetDefinitions",
  "name": "Audit CIS Implementation Group 2 Level 1 controls"
}