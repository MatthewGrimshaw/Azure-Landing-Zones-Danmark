{
  "properties": {
    "displayName": "Audit CIS Implementation Group 1 Level 2 controls",
    "policyType": "Custom",
    "description": "This policy initiative is a group of policies that Audits CIS Implementation Group 1 Level 2 controls.",
    "metadata": {
      "version": "1.0",
      "category": "Regulatory Compliance"
    },
    "parameters": {
        "effect-0e6763cc-5078-4e64-889d-ff4d9a839047": {
            "type": "String",
            "defaultValue": "AuditIfNotExists",
            "allowedValues": [
                "AuditIfNotExists",
                "Disabled"
            ],
            "metadata": {
                "displayName": "Effect for policy: Azure Defender for Key Vault should be enabled",
                "description": "For more information about effects, visit https://aka.ms/policyeffects"
            }
        },
        "effect-1c988dd6-ade4-430f-a608-2a3e5b0a6d38": {
            "type": "String",
            "defaultValue": "AuditIfNotExists",
            "allowedValues": [
                "AuditIfNotExists",
                "Disabled"
            ],
            "metadata": {
                "displayName": "Effect for policy: Microsoft Defender for Containers should be enabled",
                "description": "For more information about effects, visit https://aka.ms/policyeffects"
            }
        },
        "effect-2913021d-f2fd-4f3d-b958-22354e2bdbcb": {
            "type": "String",
            "defaultValue": "AuditIfNotExists",
            "allowedValues": [
                "AuditIfNotExists",
                "Disabled"
            ],
            "metadata": {
                "displayName": "Effect for policy: Azure Defender for App Service should be enabled",
                "description": "For more information about effects, visit https://aka.ms/policyeffects"
            }
        },
        "effect-308fbb08-4ab8-4e67-9b29-592e93fb94fa": {
            "type": "String",
            "defaultValue": "AuditIfNotExists",
            "allowedValues": [
                "AuditIfNotExists",
                "Disabled"
            ],
            "metadata": {
                "displayName": "Effect for policy: Azure Defender for Storage should be enabled",
                "description": "For more information about effects, visit https://aka.ms/policyeffects"
            }
        },
        "effect-4da35fc9-c9e7-4960-aec9-797fe7d9051d": {
            "type": "String",
            "defaultValue": "AuditIfNotExists",
            "allowedValues": [
                "AuditIfNotExists",
                "Disabled"
            ],
            "metadata": {
                "displayName": "Effect for policy: Azure Defender for servers should be enabled",
                "description": "For more information about effects, visit https://aka.ms/policyeffects"
            }
        },
        "effect-5bb220d9-2698-4ee4-8404-b9c30c9df609": {
            "type": "String",
            "defaultValue": "Audit",
            "allowedValues": [
                "Audit",
                "Disabled"
            ],
            "metadata": {
                "displayName": "Effect for policy: Ensure WEB app has 'Client Certificates (Incoming client certificates)' set to 'On'",
                "description": "For more information about effects, visit https://aka.ms/policyeffects"
            }
        },
        "effect-6581d072-105e-4418-827f-bd446d56421b": {
            "type": "String",
            "defaultValue": "AuditIfNotExists",
            "allowedValues": [
                "AuditIfNotExists",
                "Disabled"
            ],
            "metadata": {
                "displayName": "Effect for policy: Azure Defender for SQL servers on machines should be enabled",
                "description": "For more information about effects, visit https://aka.ms/policyeffects"
            }
        },
        "effect-7fe3b40f-802b-4cdd-8bd4-fd799c948cc2": {
            "type": "String",
            "defaultValue": "AuditIfNotExists",
            "allowedValues": [
                "AuditIfNotExists",
                "Disabled"
            ],
            "metadata": {
                "displayName": "Effect for policy: Azure Defender for Azure SQL Database servers should be enabled",
                "description": "For more information about effects, visit https://aka.ms/policyeffects"
            }
        },
        "effect-95bccee9-a7f8-4bec-9ee9-62c3473701fc": {
            "type": "String",
            "defaultValue": "AuditIfNotExists",
            "allowedValues": [
                "AuditIfNotExists",
                "Disabled"
            ],
            "metadata": {
                "displayName": "Effect for policy: Authentication should be enabled on your web app",
                "description": "For more information about effects, visit https://aka.ms/policyeffects"
            }
        },
        "effect-c75248c1-ea1d-4a9c-8fc9-29a6aabd5da8": {
            "type": "String",
            "defaultValue": "AuditIfNotExists",
            "allowedValues": [
                "AuditIfNotExists",
                "Disabled"
            ],
            "metadata": {
                "displayName": "Effect for policy: Authentication should be enabled on your Function app",
                "description": "For more information about effects, visit https://aka.ms/policyeffects"
            }
        },
        "effect-c9d007d0-c057-4772-b18c-01e546713bcd": {
            "type": "String",
            "defaultValue": "Audit",
            "allowedValues": [
                "Audit",
                "Deny",
                "Disabled"
            ],
            "metadata": {
                "displayName": "Effect for policy: Storage accounts should allow access from trusted Microsoft services",
                "description": "For more information about effects, visit https://aka.ms/policyeffects"
            }
        },
        "effect-e3576e28-8b17-4677-84c3-db2990658d64": {
            "type": "String",
            "defaultValue": "AuditIfNotExists",
            "allowedValues": [
                "AuditIfNotExists",
                "Disabled"
            ],
            "metadata": {
                "displayName": "Effect for policy: MFA should be enabled on accounts with read permissions on your subscription",
                "description": "For more information about effects, visit https://aka.ms/policyeffects"
            }
        },
        "effect-eaebaea7-8013-4ceb-9d14-7eb32271373c": {
            "type": "String",
            "defaultValue": "Audit",
            "allowedValues": [
                "Audit",
                "Disabled"
            ],
            "metadata": {
                "displayName": "Effect for policy: Ensure Function app has 'Client Certificates (Incoming client certificates)' set to 'On'",
                "description": "For more information about effects, visit https://aka.ms/policyeffects"
            }
        },
        "effect-fbb99e8e-e444-4da0-9ff1-75c92f5a85b2": {
            "type": "String",
            "defaultValue": "AuditIfNotExists",
            "allowedValues": [
                "AuditIfNotExists",
                "Disabled"
            ],
            "metadata": {
                "displayName": "Effect for policy: Storage account containing the container with activity logs must be encrypted with BYOK",
                "description": "For more information about effects, visit https://aka.ms/policyeffects"
            }
        }
    },
    "policyDefinitions":[
        {
            "policyDefinitionReferenceId": "e3576e28-8b17-4677-84c3-db2990658d64",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/e3576e28-8b17-4677-84c3-db2990658d64",
            "parameters": {
                "effect": {
                    "value": "[parameters('effect-e3576e28-8b17-4677-84c3-db2990658d64')]"
                }
            },
            "groupNames": [
                "CIS_Azure_1.4.0_1.2"
            ]
        },
        {
            "policyDefinitionReferenceId": "4da35fc9-c9e7-4960-aec9-797fe7d9051d",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/4da35fc9-c9e7-4960-aec9-797fe7d9051d",
            "parameters": {
                "effect": {
                    "value": "[parameters('effect-4da35fc9-c9e7-4960-aec9-797fe7d9051d')]"
                }
            },
            "groupNames": [
                "CIS_Azure_1.4.0_2.1"
            ]
        },
        {
            "policyDefinitionReferenceId": "2913021d-f2fd-4f3d-b958-22354e2bdbcb",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2913021d-f2fd-4f3d-b958-22354e2bdbcb",
            "parameters": {
                "effect": {
                    "value": "[parameters('effect-2913021d-f2fd-4f3d-b958-22354e2bdbcb')]"
                }
            },
            "groupNames": [
                "CIS_Azure_1.4.0_2.2"
            ]
        },
        {
            "policyDefinitionReferenceId": "7fe3b40f-802b-4cdd-8bd4-fd799c948cc2",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/7fe3b40f-802b-4cdd-8bd4-fd799c948cc2",
            "parameters": {
                "effect": {
                    "value": "[parameters('effect-7fe3b40f-802b-4cdd-8bd4-fd799c948cc2')]"
                }
            },
            "groupNames": [
                "CIS_Azure_1.4.0_2.3"
            ]
        },
        {
            "policyDefinitionReferenceId": "6581d072-105e-4418-827f-bd446d56421b",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6581d072-105e-4418-827f-bd446d56421b",
            "parameters": {
                "effect": {
                    "value": "[parameters('effect-6581d072-105e-4418-827f-bd446d56421b')]"
                }
            },
            "groupNames": [
                "CIS_Azure_1.4.0_2.4"
            ]
        },
        {
            "policyDefinitionReferenceId": "308fbb08-4ab8-4e67-9b29-592e93fb94fa",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/308fbb08-4ab8-4e67-9b29-592e93fb94fa",
            "parameters": {
                "effect": {
                    "value": "[parameters('effect-308fbb08-4ab8-4e67-9b29-592e93fb94fa')]"
                }
            },
            "groupNames": [
                "CIS_Azure_1.4.0_2.5"
            ]
        },
        {
            "policyDefinitionReferenceId": "1c988dd6-ade4-430f-a608-2a3e5b0a6d38",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1c988dd6-ade4-430f-a608-2a3e5b0a6d38",
            "parameters": {
                "effect": {
                    "value": "[parameters('effect-1c988dd6-ade4-430f-a608-2a3e5b0a6d38')]"
                }
            },
            "groupNames": [
                "CIS_Azure_1.4.0_2.6",
                "CIS_Azure_1.4.0_2.7"
            ]
        },
        {
            "policyDefinitionReferenceId": "0e6763cc-5078-4e64-889d-ff4d9a839047",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0e6763cc-5078-4e64-889d-ff4d9a839047",
            "parameters": {
                "effect": {
                    "value": "[parameters('effect-0e6763cc-5078-4e64-889d-ff4d9a839047')]"
                }
            },
            "groupNames": [
                "CIS_Azure_1.4.0_2.8"
            ]
        },
        {
            "policyDefinitionReferenceId": "c9d007d0-c057-4772-b18c-01e546713bcd",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c9d007d0-c057-4772-b18c-01e546713bcd",
            "parameters": {
                "effect": {
                    "value": "[parameters('effect-c9d007d0-c057-4772-b18c-01e546713bcd')]"
                }
            },
            "groupNames": [
                "CIS_Azure_1.4.0_3.7"
            ]
        },
        {
            "policyDefinitionReferenceId": "fbb99e8e-e444-4da0-9ff1-75c92f5a85b2",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/fbb99e8e-e444-4da0-9ff1-75c92f5a85b2",
            "parameters": {
                "effect": {
                    "value": "[parameters('effect-fbb99e8e-e444-4da0-9ff1-75c92f5a85b2')]"
                }
            },
            "groupNames": [
                "CIS_Azure_1.4.0_5.1.4"
            ]
        },
        {
            "policyDefinitionReferenceId": "c75248c1-ea1d-4a9c-8fc9-29a6aabd5da8",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c75248c1-ea1d-4a9c-8fc9-29a6aabd5da8",
            "parameters": {
                "effect": {
                    "value": "[parameters('effect-c75248c1-ea1d-4a9c-8fc9-29a6aabd5da8')]"
                }
            },
            "groupNames": [
                "CIS_Azure_1.4.0_9.1"
            ]
        },
        {
            "policyDefinitionReferenceId": "95bccee9-a7f8-4bec-9ee9-62c3473701fc",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/95bccee9-a7f8-4bec-9ee9-62c3473701fc",
            "parameters": {
                "effect": {
                    "value": "[parameters('effect-95bccee9-a7f8-4bec-9ee9-62c3473701fc')]"
                }
            },
            "groupNames": [
                "CIS_Azure_1.4.0_9.1"
            ]
        },
        {
            "policyDefinitionReferenceId": "eaebaea7-8013-4ceb-9d14-7eb32271373c",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/eaebaea7-8013-4ceb-9d14-7eb32271373c",
            "parameters": {
                "effect": {
                    "value": "[parameters('effect-eaebaea7-8013-4ceb-9d14-7eb32271373c')]"
                }
            },
            "groupNames": [
                "CIS_Azure_1.4.0_9.4"
            ]
        },
        {
            "policyDefinitionReferenceId": "5bb220d9-2698-4ee4-8404-b9c30c9df609",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5bb220d9-2698-4ee4-8404-b9c30c9df609",
            "parameters": {
                "effect": {
                    "value": "[parameters('effect-5bb220d9-2698-4ee4-8404-b9c30c9df609')]"
                }
            },
            "groupNames": [
                "CIS_Azure_1.4.0_9.4"
            ]
        }
    ],
    "policyDefinitionGroups": [
        {
            "name": "CIS_Azure_1.4.0_1.2",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_1.2"
        },
        {
            "name": "CIS_Azure_1.4.0_2.1",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_2.1"
        },
        {
            "name": "CIS_Azure_1.4.0_2.2",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_2.2"
        },
        {
            "name": "CIS_Azure_1.4.0_2.3",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_2.3"
        },
        {
            "name": "CIS_Azure_1.4.0_2.4",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_2.4"
        },
        {
            "name": "CIS_Azure_1.4.0_2.5",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_2.5"
        },
        {
            "name": "CIS_Azure_1.4.0_2.6",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_2.6"
        },
        {
            "name": "CIS_Azure_1.4.0_2.7",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_2.7"
        },
        {
            "name": "CIS_Azure_1.4.0_2.8",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_2.8"
        },
        {
            "name": "CIS_Azure_1.4.0_3.7",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_3.7"
        },
        {
            "name": "CIS_Azure_1.4.0_5.1.4",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_5.1.4"
        },
        {
            "name": "CIS_Azure_1.4.0_9.1",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_9.1"
        },
        {
            "name": "CIS_Azure_1.4.0_9.4",
            "additionalMetadataId": "/providers/Microsoft.PolicyInsights/policyMetadata/CIS_Azure_1.4.0_9.4"
        }
    ]
  },
  "type": "Microsoft.Authorization/policySetDefinitions",
  "name": "Audit CIS Implementation Group 1 Level 2 controls"
}